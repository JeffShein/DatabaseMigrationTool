<Window x:Class="DatabaseMigrationTool.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:DatabaseMigrationTool"
        xmlns:controls="clr-namespace:DatabaseMigrationTool.Controls"
        mc:Ignorable="d"
        Title="Database Migration Tool" Height="900" Width="1200"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#0078D7" Padding="15">
            <TextBlock Text="Database Migration Tool" FontSize="22" FontWeight="SemiBold" Foreground="White" />
        </Border>

        <!-- Main content -->
        <TabControl Grid.Row="1" Margin="10">
            <TabItem Header="Export">
                <ScrollViewer>
                    <StackPanel Margin="10">
                        <GroupBox Header="Connection Settings" Margin="0,0,0,15">
                            <Grid Margin="10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <controls:ConnectionStringControl 
                                    x:Name="ExportConnectionControl"
                                    Grid.Row="0" Grid.ColumnSpan="2" 
                                    ConnectionString="{Binding ExportConnectionString, Mode=TwoWay}"
                                    ProviderIndex="{Binding ExportProviderIndex, Mode=TwoWay}"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Output Directory:" VerticalAlignment="Center"/>
                                <Grid Grid.Row="2" Grid.Column="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Grid.Column="0" x:Name="ExportOutputDirectoryTextBox" Margin="5"/>
                                    <Button Grid.Column="1" Content="Browse..." Margin="5" Padding="10,0" Click="BrowseExportOutputDirectory"/>
                                </Grid>
                            </Grid>
                        </GroupBox>

                        <GroupBox Header="Export Options" Margin="0,0,0,15">
                            <Grid Margin="10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Tables:" VerticalAlignment="Center"/>
                                <Grid Grid.Row="0" Grid.Column="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Grid.Column="0" x:Name="ExportTablesTextBox" Margin="5"
                                             ToolTip="Comma-separated list of tables. Leave blank to export all tables."/>
                                    <Button Grid.Column="1" Content="Browse..." Margin="2,5,2,5" Padding="8,2" 
                                            Click="BrowseExportTables_Click" ToolTip="Browse available tables"/>
                                    <Button Grid.Column="2" Content="✖" Margin="2,5,5,5" Padding="8,2" 
                                            Click="ClearExportTables_Click" ToolTip="Clear table list"/>
                                </Grid>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Table Criteria:" VerticalAlignment="Center"/>
                                <Grid Grid.Row="1" Grid.Column="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Grid.Column="0" x:Name="ExportTableCriteriaFileTextBox" Margin="5"
                                             ToolTip="Path to JSON file with table criteria"/>
                                    <Button Grid.Column="1" Content="Browse..." Margin="5" Padding="10,0" Click="BrowseTableCriteriaFile"/>
                                </Grid>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Batch Size:" VerticalAlignment="Center"/>
                                <TextBox Grid.Row="2" Grid.Column="1" x:Name="ExportBatchSizeTextBox" Margin="5" Text="100000"/>

                                <TextBlock Grid.Row="3" Grid.Column="0" Text="Schema Only:" VerticalAlignment="Center"/>
                                <CheckBox Grid.Row="3" Grid.Column="1" x:Name="ExportSchemaOnlyCheckBox" Margin="10" 
                                          VerticalAlignment="Center" Content="Export schema only (no data)"/>
                            </Grid>
                        </GroupBox>

                        <Button x:Name="ExportButton" Content="Start Export" HorizontalAlignment="Center" Padding="20,10" Click="StartExport"/>
                        
                        <!-- Export Progress -->
                        <GroupBox Header="Export Progress" Margin="0,15,0,0" x:Name="ExportProgressGroupBox" Visibility="Collapsed">
                            <Grid Margin="10">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <ProgressBar Grid.Row="0" x:Name="ExportProgressBar" Height="20" Margin="0,0,0,5"/>
                                <TextBlock Grid.Row="1" Grid.ColumnSpan="2" x:Name="ExportProgressText" TextAlignment="Center" TextWrapping="Wrap"/>
                            </Grid>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <TabItem Header="Import">
                <ScrollViewer>
                    <StackPanel Margin="10">
                        <GroupBox Header="Connection Settings" Margin="0,0,0,15">
                            <Grid Margin="10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <controls:ConnectionStringControl 
                                    x:Name="ImportConnectionControl"
                                    Grid.Row="0" Grid.ColumnSpan="2" 
                                    ConnectionString="{Binding ImportConnectionString, Mode=TwoWay}"
                                    ProviderIndex="{Binding ImportProviderIndex, Mode=TwoWay}"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Input Directory:" VerticalAlignment="Center"/>
                                <Grid Grid.Row="2" Grid.Column="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Grid.Column="0" x:Name="ImportInputDirectoryTextBox" Margin="5"/>
                                    <Button Grid.Column="1" Content="Browse..." Margin="5" Padding="10,0" Click="BrowseImportInputDirectory"/>
                                </Grid>
                            </Grid>
                        </GroupBox>

                        <GroupBox Header="Import Options" Margin="0,0,0,15">
                            <Grid Margin="10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="150"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Tables:" VerticalAlignment="Center"/>
                                <Grid Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="3">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Grid.Column="0" x:Name="ImportTablesTextBox" Margin="5"
                                             ToolTip="Comma-separated list of tables. Leave blank to import all tables."/>
                                    <Button Grid.Column="1" Content="Browse..." Margin="2,5,2,5" Padding="8,2" 
                                            Click="BrowseImportTables_Click" ToolTip="Browse available tables"/>
                                    <Button Grid.Column="2" Content="✖" Margin="2,5,5,5" Padding="8,2" 
                                            Click="ClearImportTables_Click" ToolTip="Clear table list"/>
                                </Grid>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Batch Size:" VerticalAlignment="Center"/>
                                <TextBox Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="3" x:Name="ImportBatchSizeTextBox" Margin="5" Text="100000"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Create Schema:" VerticalAlignment="Center"/>
                                <CheckBox Grid.Row="2" Grid.Column="1" x:Name="ImportCreateSchemaCheckBox" Margin="10" 
                                          VerticalAlignment="Center" Content="Create database schema" IsChecked="True"/>
                                
                                <CheckBox Grid.Row="2" Grid.Column="3" x:Name="ImportSchemaOnlyCheckBox" Margin="10" 
                                          VerticalAlignment="Center" Content="Import schema only (no data)" HorizontalAlignment="Left"/>

                                <TextBlock Grid.Row="3" Grid.Column="0" Text="Create Foreign Keys:" VerticalAlignment="Center"/>
                                <CheckBox Grid.Row="3" Grid.Column="1" x:Name="ImportCreateForeignKeysCheckBox" Margin="10" 
                                          VerticalAlignment="Center" Content="Create foreign key constraints" IsChecked="True"/>
                                
                                <CheckBox Grid.Row="3" Grid.Column="3" x:Name="ImportContinueOnErrorCheckBox" Margin="10" 
                                          VerticalAlignment="Center" Content="Continue processing on error" HorizontalAlignment="Left"/>
                            </Grid>
                        </GroupBox>

                        <Button x:Name="ImportButton" Content="Start Import" HorizontalAlignment="Center" Padding="20,10" Click="StartImport"/>
                        
                        <!-- Import Progress -->
                        <GroupBox Header="Import Progress" Margin="0,15,0,0" x:Name="ImportProgressGroupBox" Visibility="Collapsed">
                            <Grid Margin="10">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <ProgressBar Grid.Row="0" x:Name="ImportProgressBar" Height="20" Margin="0,0,0,5"/>
                                <TextBlock Grid.Row="1" Grid.ColumnSpan="2" x:Name="ImportProgressText" TextAlignment="Center" TextWrapping="Wrap"/>
                            </Grid>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <TabItem Header="Schema View">
                <ScrollViewer>
                    <StackPanel Margin="10">
                        <GroupBox Header="Connection Settings" Margin="0,0,0,15">
                            <Grid Margin="10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <controls:ConnectionStringControl 
                                    x:Name="SchemaConnectionControl"
                                    Grid.Row="0" Grid.ColumnSpan="2" 
                                    ConnectionString="{Binding SchemaConnectionString, Mode=TwoWay}"/>
                            </Grid>
                        </GroupBox>

                        <GroupBox Header="Schema Options" Margin="0,0,0,15">
                            <Grid Margin="10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Tables:" VerticalAlignment="Center"/>
                                <Grid Grid.Row="0" Grid.Column="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Grid.Column="0" x:Name="SchemaTablesTextBox" Margin="5"
                                             ToolTip="Comma-separated list of tables. Leave blank to view all tables."/>
                                    <Button Grid.Column="1" Content="Browse..." Margin="2,5,2,5" Padding="8,2" 
                                            Click="BrowseSchemaTables_Click" ToolTip="Browse available tables"/>
                                    <Button Grid.Column="2" Content="✖" Margin="2,5,5,5" Padding="8,2" 
                                            Click="ClearSchemaTables_Click" ToolTip="Clear table list"/>
                                </Grid>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Detailed View:" VerticalAlignment="Center"/>
                                <CheckBox Grid.Row="1" Grid.Column="1" x:Name="SchemaVerboseCheckBox" Margin="10" 
                                          VerticalAlignment="Center" Content="Show detailed schema information"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Generate Scripts:" VerticalAlignment="Center"/>
                                <CheckBox Grid.Row="2" Grid.Column="1" x:Name="SchemaScriptOutputCheckBox" Margin="10" 
                                          VerticalAlignment="Center" Content="Generate SQL scripts" 
                                          Checked="SchemaScriptOutputCheckBox_Changed"
                                          Unchecked="SchemaScriptOutputCheckBox_Changed"/>

                                <TextBlock Grid.Row="3" Grid.Column="0" Text="Script Output Path:" VerticalAlignment="Center"/>
                                <Grid Grid.Row="3" Grid.Column="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox Grid.Column="0" x:Name="SchemaScriptPathTextBox" Margin="5" IsEnabled="{Binding ElementName=SchemaScriptOutputCheckBox, Path=IsChecked}"/>
                                    <Button Grid.Column="1" Content="Browse..." Margin="5" Padding="10,0" Click="BrowseSchemaScriptPath"
                                            IsEnabled="{Binding ElementName=SchemaScriptOutputCheckBox, Path=IsChecked}"/>
                                </Grid>
                            </Grid>
                        </GroupBox>

                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <Button Content="View Schema" Padding="20,10" Margin="5,0" Click="ViewSchema"/>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>
        
        <!-- Status bar -->
        <StatusBar Grid.Row="2">
            <StatusBarItem>
                <TextBlock x:Name="StatusTextBlock" Text="Ready"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>